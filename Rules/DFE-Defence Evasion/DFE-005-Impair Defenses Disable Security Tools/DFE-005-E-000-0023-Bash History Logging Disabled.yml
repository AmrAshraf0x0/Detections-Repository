title: DFE-005-E-000-0023-Bash History Logging Disabled
id: dfe-005-e-000-0023
status: experimental
description: Detects bash history logging being disabled which could indicate defense evasion techniques to avoid command logging
references:
    - https://attack.mitre.org/techniques/T1562.001/
author: HexaPrime Detection Team
date: 2025/12/13
tags:
    - attack.T1562.001
    - attack.defense_evasion
logsource:
    product: linux
    category: process_creation
detection:
    selection1:
        CommandLine|contains:
            - 'export HISTSIZE=0'
            - 'unset HISTFILE'
            - 'export HISTFILE=/dev/null'
            - 'set +o history'
    selection2:
        Image|endswith:
            - '/rm'
            - '/unlink'
        CommandLine|contains:
            - '.bash_history'
            - '.zsh_history'
    selection3:
        Image|endswith:
            - '/ln'
        CommandLine|contains:
            - '.bash_history'
            - '/dev/null'
    condition: 1 of selection*
falsepositives:
    - Privacy-conscious users
    - Legitimate administrative scripts
    - Security testing procedures
level: medium