title: CRA-007-E-000-0001-Extract all accounts using setspn
id: cra-007-e-000-0001
status: experimental
description: Detects usage of setspn command to extract service accounts, commonly used for Kerberoasting preparation
references:
    - https://attack.mitre.org/techniques/T1558.003/
    - https://attack.mitre.org/techniques/T1087.002/
author: HexaPrime Detection Team
date: 2025/12/13
tags:
    - attack.T1558.003
    - attack.T1087.002
    - attack.credential_access
    - attack.discovery
logsource:
    product: windows
    category: process_creation
detection:
    selection:
        Image|endswith: '\setspn.exe'
        CommandLine|contains:
            - '-T'
            - '-Q'
            - '*/*'
    condition: selection
falsepositives:
    - Legitimate Active Directory administration
    - Service account management
    - System troubleshooting
level: medium