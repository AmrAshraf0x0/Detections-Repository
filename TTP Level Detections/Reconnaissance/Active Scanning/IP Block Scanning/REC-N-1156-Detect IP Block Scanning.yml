title: Detect IP Block Scanning
id: detect-ip-block-scanning-firewall
status: Developed
description: Detects IP block scanning attempts based on a single source IP rapidly probing multiple destination IPs or ports in firewall logs.
author: Amr Ashraf
date: 2024-11-24
logsource:
  category: firewall
  product: any
detection:
  selection:
    action: allow   # Logs traffic permitted by the firewall (optional; depends on firewall configuration)
  aggregation:
    by:
      - source_ip
    timeframe: 1m  # Aggregates events over a 1-minute window
    count: 50      # Threshold for connections to multiple destination IPs
  condition: selection and aggregation
fields:
  - source_ip
  - destination_ip
  - destination_port
  - protocol
  - timestamp
level: high
tags:
  - attack.reconnaissance
  - detection.firewall
  - network.activity
falsepositives:
  - Network scanning by authorized tools (e.g., vulnerability scanners)
  - Penetration testing or administrative activity
