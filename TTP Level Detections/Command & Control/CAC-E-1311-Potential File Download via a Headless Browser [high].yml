title: Potential File Download via a Headless Browser
description: Detects the use of a browser to download files from a remote URL, originating from a suspicious parent process. Adversaries may use headless browsers to bypass ingress tool transfer restrictions.
status: Developed
date: 2024-12-01
author: Amr Ashraf
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    process_name:
      - "chrome.exe"
      - "msedge.exe"
      - "brave.exe"
      - "browser.exe"
      - "dragon.exe"
      - "vivaldi.exe"
    process_args:
      - "--headless*"
      - "data:text/html;base64,*"
    parent_process_name:
      - "cmd.exe"
      - "powershell.exe"
      - "wscript.exe"
      - "cscript.exe"
      - "mshta.exe"
      - "conhost.exe"
      - "msiexec.exe"
      - "explorer.exe"
      - "rundll32.exe"
      - "winword.exe"
      - "excel.exe"
      - "onenote.exe"
      - "hh.exe"
      - "powerpnt.exe"
      - "forfiles.exe"
      - "pcalua.exe"
      - "wmiprvse.exe"
  condition: selection
fields:
  - process_name
  - process_args
  - parent_process_name
  - user_id
  - host_name
falsepositives:
  - Legitimate administrative or testing use of headless browsers
  - Authorized development activities involving headless browser automation
level: high
tags:
  - attack.command_and_control
  - attack.T1105
