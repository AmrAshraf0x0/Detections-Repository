title: Linux Domain Account Enumeration
description: Detects commands used to enumerate domain accounts on Linux.
status: Developed
author: Yuliya Volkova
date: 2024/11/12
modified: 2024/11/12
logsource:
  category: process_creation
  product: linux
detection:
  selection:
    commandline|contains|any:
      - "ldapsearch"
      - "ldapwhoami"
      - "getent passwd"
      - "getent group"
      - "wbinfo -u"
      - "wbinfo -g"
      - "id"
      - "net ads search"
  selection1:
    Commandline|contains|any:
      - "cat /etc/sssd/sssd.conf"
      - "cat /etc/nsswitch.conf"
      - "ls -la /etc/krb5.conf"
  condition: selection OR selection1 # Does not require exclusion at this point in time
fields:
  - Image
  - Commandline
  - User
  - Hostname
falsepositives:
  - Legitimate administrative queries by authorized users.
  - Routine configuration checks or system scripts.
level: medium
tags:
  - attack.account_discovery
  - attack.t1087.002