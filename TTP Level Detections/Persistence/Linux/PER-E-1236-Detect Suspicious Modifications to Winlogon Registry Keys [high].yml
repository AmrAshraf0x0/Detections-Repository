title: Detect Suspicious Modifications to Winlogon Registry Keys
status: Developed
description: Detects modifications to critical Winlogon registry keys used for helper DLLs.
author: Amr Ashraf
logsource:
  category: registry
  product: windows
detection:
  selection:
    EventID: 4657  # Registry modification event
    RegistryKey|contains: 'HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon'
    RegistryValueName|contains:
      - 'Userinit'
      - 'Shell'
      - 'GinaDLL'
  condition: selection
fields:
  - RegistryKey
  - RegistryValueName
  - NewValue
  - User
  - ComputerName
level: high
tags:
  - attack.persistence
  - attack.privilege_escalation
  - t1547.004
falsepositives:
  - Legitimate changes by administrators or system updates
