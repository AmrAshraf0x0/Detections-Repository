title: Detect Registry Changes for Path Hijacking
description: Detects modifications to registry keys that define DLL and executable search paths.
status: Developed
author: Amr Ashraf
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID: 4657
    RegistryKey|contains: 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\KnownDLLs'
  condition: selection
fields:
 - EventID
 - RegistryKey
 - RegistryValue
 - OldValue
 - NewValue
falsepositives:
 - Legitimate changes to DLL search paths
level: high
tags:
 - attack.persistence
 - attack.t1574.001