title: Detect Service creation using PowerShell Script Block Logging
description: Detects the execution of PowerShell scripts and commands using script block logging.
status: Developed
author: Amr Ashraf
logsource:
  product: windows
  service: powershell
detection:
  selection:
    EventID: 4104
    ScriptBlockText|contains: 'New-Service'
  condition: selection
fields:
 - EventID
 - ScriptBlockText
falsepositives:
 - Legitimate use of PowerShell scripts
level: high
tags:
 - attack.persistence
 - attack.t1543.003