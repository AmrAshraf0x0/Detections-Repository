title: Detect Activation of Guest Account on Windows
status: Developed
description: Detects the activation of the default Guest account, which is disabled by default in Windows environments, potentially indicating unauthorized access attempts.
author: Amr Ashraf
date: 2024-12-06
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    EventID: 4688
    CommandLine|contains|all:
      - 'net'
      - 'user'
      - 'guest'
      - '/active:yes'
  condition: selection
fields:
  - CommandLine
  - User
  - ParentImage
  - Hostname
falsepositives:
  - Legitimate administrative actions enabling the Guest account.
level: high
tags:
  - attack.privilege_escalation
  - aT1078.001
VQL:
  LET ID_1499 = (
      CommandLine =~ "(?=.*net)(?=.*user)(?=.*guest)(?=.*\\/active:yes)"
  )
