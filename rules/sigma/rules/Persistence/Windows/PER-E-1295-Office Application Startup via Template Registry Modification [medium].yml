title: Office Application Startup via Template Registry Modification
status: Experimental
description: Detects modifications to Microsoft Office-related registry keys that adversaries can use to establish persistence by altering templates or add-ins.
author: Amr Ashraf
logsource:
  category: registry
  product: windows
detection:
  selection:
    - EventID: 4657
    - ObjectName|contains:
        - '\Software\Microsoft\Office\'
        - '\Outlook\Today\UserDefinedUrl'
        - '\Excel\Options\Open'
        - '\PowerPoint\AddIns'
        - '\Addins\'
        - '\VBE\Addins\'
  condition: selection
fields:
  - RegistryPath
  - RegistryKey
  - RegistryValue
  - User
  - Hostname
  - Action
level: medium
tags:
  - attack.persistence
  - t1137
falsepositives:
  - Legitimate modifications to Office registry keys by users or software
  - Authorized administrative or IT tasks modifying these registry entries