title: ChromeLoader Malware Execution
status: Experimental
description: Detects execution of ChromeLoader malware via a registered scheduled task
references:
    - https://github.com/xephora/Threat-Remediation-Scripts/tree/main/Threat-Track/CS_INSTALLER
    - https://twitter.com/th3_protoCOL/status/1480621526764322817
    - https://twitter.com/Kostastsale/status/1480716528421011458
    - https://www.virustotal.com/gui/file/ded20df574b843aaa3c8e977c2040e1498ae17c12924a19868df5b12dee6dfdd
author: 'Amr Ashraf'
date: 2024-12-24
tags:
    - attack.execution
    - attack.persistence
    - attack.t1053.005
    - attack.t1059.001
    - attack.t1176
    - detection.emerging-threats
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        ParentProcessName|endswith: '\powershell.exe'
        ParentCommandLine|contains: '-ExecutionPolicy Bypass -WindowStyle Hidden -E JAB'
        CommandLine|contains: '--load-extension="*\Appdata\local\chrome"'
        NewProcessName|endswith: '\chrome.exe'
        EventID: 4688
    VQL: |
        LET ID_1728 = (
            ParentProcessName =~ "\\powershell\\.exe$" AND
            ParentCommandLine =~ "-ExecutionPolicy Bypass -WindowStyle Hidden -E JAB" AND
            CommandLine =~ "--load-extension=\".*\\Appdata\\local\\chrome\"" AND
            NewProcessName =~ "\\chrome\\.exe$"
        )
    condition: selection
falsepositives:
    - Unlikely
level: high
