title: Detect Unauthorized Executables Running from Windows folder
description: Detects any executable running directly from C:\Windows that is not one of the specified allowed executables.
status: Experimental
author: Amr Ashraf
date: 2024/09/23
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    NewProcessName|endswith:
      - '\Windows\*.exe'
  filter:
    NewProcessName|endswith:
      - '\Windows\write.exe'
      - '\Windows\winhlp32.exe'
      - '\Windows\splwow64.exe'
      - '\Windows\regedit.exe'
      - '\Windows\notepad.exe'
      - '\Windows\hh.exe'
      - '\Windows\HelpPane.exe'
      - '\Windows\explorer.exe'
      - '\Windows\bfsvc.exe'
  condition: selection and not filter
fields:
  - CommandLine
  - Image
  - ParentImage
  - User
falsepositives:
  - Legitimate software updates or installers may run from C:\Windows
level: high
tags:
  - attack.execution
  - attack.t1059