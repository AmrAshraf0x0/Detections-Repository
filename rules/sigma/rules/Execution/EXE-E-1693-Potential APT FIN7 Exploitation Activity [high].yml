title: Potential APT FIN7 Exploitation Activity
status: Developed
description: |
    Detects potential APT FIN7 exploitation activity as reported by Google.
    In order to obtain initial access, FIN7 used compromised Remote Desktop Protocol (RDP) credentials to login to a target server and initiate specific Windows process chains.
references:
    - https://cloud.google.com/blog/topics/threat-intelligence/evolution-of-fin7/
author: Amr Ashraf
date: 2024/12/24
tags:
    - attack.execution
    - attack.t1059.001
    - attack.t1059.003
logsource:
    category: process_creation
    product: windows
detection:
    selection_notepad_plus:
        EventID: 4688
        ParentProcessName|endswith: '\notepad++.exe'
        NewProcessName|endswith: '\cmd.exe'
    selection_rdpinit:
        EventID: 4688
        ParentProcessName|endswith: '\rdpinit.exe'
        NewProcessName|endswith: '\notepad++.exe'
    
    condition: 1 of selection_*
falsepositives:
    - Unknown
level: medium
VQL: |
    LET ID_1693 = (
        (ParentProcessName =~ "\\notepad\\+\\+\\.exe$" AND NewProcessName =~ "\\cmd\\.exe$") OR
        (ParentProcessName =~ "\\rdpinit\\.exe$" AND NewProcessName =~ "\\notepad\\+\\+\\.exe$")
    )
