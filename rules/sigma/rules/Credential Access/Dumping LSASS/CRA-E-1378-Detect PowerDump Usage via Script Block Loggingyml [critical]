title: Detect PowerDump Usage via Script Block Logging
status: Experimental
description: Detects the usage of PowerDump or PowerView tools via script block logging. These tools are often used for credential dumping and Active Directory enumeration.
author: Amr Ashraf
date: 2024-12-06
logsource:
  category: script
  product: windows
detection:
  selection:
    EventID: 4104
    ScriptBlockText|contains:
      # PowerDump related commands and keywords
      - 'lsass'
      - 'MiniDump'
      - 'Invoke-Mimikatz'
      - 'Write-MemoryDump'
      - 'DumpCreds'
      - 'Invoke-NinjaCopy'
  condition: selection
fields:
  - EventID
  - ScriptBlockText
  - UserID
  - Computer
  - LogonID
falsepositives:
  - Legitimate administrative or Active Directory enumeration tasks
  - Testing and debugging PowerShell scripts
  - Penetration testing activity with proper authorization
level: critical
tags:
  - attack.credential_access
  - attack.t1003
