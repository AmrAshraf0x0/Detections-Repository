title: Detect Unsecured Credential Access via Bash History
id: detect-bash-history-credential-access
status: Experimental
description: Detects suspicious access to Bash history files, which may indicate credential harvesting attempts or data collection.
author: Amr Ashraf
logsource:
  category: process_creation
  product: linux
detection:
  selection:
    - Image|endswith:
        - '/bin/cat'
        - '/bin/less'
        - '/bin/more'
        - '/bin/grep'
        - 'vim'
        - 'nano'
      CommandLine|contains:
        - '.bash_history'
        - '~/bash_history'
  condition: selection
fields:
  - Image
  - CommandLine
  - ParentImage
  - User
  - Hostname
  - ProcessId
level: medium
tags:
  - attack.credential_access
  - t1552.003
  - attack.unsecured_credentials
falsepositives:
  - System administrators inspecting Bash history for troubleshooting purposes.
  - Legitimate usage during security or forensic analysis.
