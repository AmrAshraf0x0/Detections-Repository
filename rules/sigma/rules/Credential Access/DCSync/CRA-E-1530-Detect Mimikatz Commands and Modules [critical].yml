title: Detect Mimikatz Commands and Modules
description: Detects the execution of Mimikatz commands and modules, commonly used for credential dumping and privilege escalation.
status: developed
author: Amr Ashraf
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Event ID: 4688
    CommandLine|contains:
      - 'Invoke-Mimikatz'
      - 'mimikatz.exe'
      - 'privilege::debug'
      - 'sekurlsa::logonpasswords'
      - 'sekurlsa::tickets'
      - 'sekurlsa::wdigest'
      - 'kerberos::list'
      - 'lsadump::sam'
      - 'lsadump::secrets'
      - 'lsadump::dcsync'
      - 'crypto::certificates'
      - 'crypto::keys'
      - 'vault::cred'
      - 'token::elevate'
      - 'process::list'
      - 'process::dump'
      - 'misc::skeleton'
      - 'misc::memssp'
      - 'standard::base64'
      - 'standard::systime'
      - 'standard::reboot'
  condition: selection
fields:
  - CommandLine
  - ParentProcessName
  - ProcessId
  - User
  - LogonId
falsepositives:
  - Penetration testing tools and activities
  - Security researchers testing detection capabilities
level: critical
tags:
  - attack.credential_access
  - attack.discovery
  - attack.execution

