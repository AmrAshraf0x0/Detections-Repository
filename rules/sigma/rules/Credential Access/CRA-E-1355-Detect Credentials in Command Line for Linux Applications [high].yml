title: Detect Credentials in Command Line for Linux Applications
id: detect-credentials-in-command-line-linux
status: Experimental
description: Detects suspicious use of credentials in the command line for common Linux applications such as SSH, MySQL, FTP, and wget.
author: Amr Ashraf
logsource:
  category: process_creation
  product: linux
detection:
  selection:
    - Image|endswith:
        - '/bin/ssh'
        - '/usr/bin/sshpass'
        - '/bin/ftp'
        - '/bin/mysql'
        - '/bin/psql'
        - '/bin/wget'
        - '/bin/curl'
        - '/bin/nc'
        - '/bin/sftp'
      CommandLine|contains:
        - ' -p'
        - ' -pw'
        - ' --password'
        - ' --pass'
        - ' --key'
        - ' -key'
        - ' --token'
        - ' -token'
  filter:
    - CommandLine|contains:
        - '--help'
        - '--version'
        - '--check'
  condition: selection and not filter
fields:
  - Image
  - CommandLine
  - User
  - ParentImage
  - Hostname
  - ProcessId
  - ParentProcessId
level: high
tags:
  - attack.credential_access
  - t1552.003
  - attack.unsecured_credentials
falsepositives:
  - Legitimate administrative or troubleshooting use of command-line tools.
  - Automated scripts with credentials in command-line arguments (e.g., backup scripts).
