title: Brute Force One Password Multiple Users [aggregation]
description: Detects multiple failed logon attempts for different user accounts using the same password, which could indicate a brute force attack with a single compromised password.
status: Developed
author: Amr Ashraf
date: 2024/11/11
logsource:
  category: authentication
  product: windows
detection:
  selection:
    EventID: 4625
  aggregation:
    group_by:
      - IpAddress
    count(TargetUserName) by IpAddress > 5 within 1m 
  condition: selection and aggregation
fields:
  - EventID
  - TargetUserName
  - FailureReason
  - IpAddress
  - AccountName
  - AuthenticationPackageName
level: high
tags:
  - attack.credential_access
  - attack.t1110.001 
falsepositives:
  - Legitimate tools like password recovery software or security audits could result in multiple failed attempts from a single source IP.
  - Account lockout policies might trigger multiple failures from the same IP if several accounts are involved.
