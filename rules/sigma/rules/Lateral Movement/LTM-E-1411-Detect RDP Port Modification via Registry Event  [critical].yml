title: Detect RDP Port Modification via Registry Event
status: Experimental
description: Detects modifications to the RDP port number in the Windows registry. Changing the RDP port may indicate attempts to configure unauthorized remote access.
author: Amr Ashraf
date: 2024-12-06
logsource:
  category: registry
  product: windows
detection:
  selection:
    EventID: 4657
    ObjectName|contains: 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp'
    ObjectValueName: 'PortNumber'
  condition: selection
fields:
  - EventID
  - RegistryKey
  - RegistryValueName
  - RegistryValueData
  - User
  - Computer
  - LogonID
falsepositives:
  - Legitimate administrative tasks modifying RDP settings
  - Security tools performing authorized configuration changes
level: critical
tags:
  - attack.persistence
  - attack.lateral_movement
  - attack.t1562
  - attack.t1021
