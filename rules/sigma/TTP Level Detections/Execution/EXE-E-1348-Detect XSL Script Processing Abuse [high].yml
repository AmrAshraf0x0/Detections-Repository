title: Detect XSL Script Processing Abuse
id: detect-xsl-script-processing
status: Developed
description: Detects execution of XSL scripts via tools like wmic.exe or PowerShell, which may indicate malicious activity.
author: Amr Ashraf
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    - NewProcessName|endswith:
        - '\wmic.exe'
      CommandLine|contains:
        - '/FORMAT:*'
        - '.xsl'
    - NewProcessName|endswith:
        - '\powershell.exe'
      CommandLine|contains:
        - 'TransformNode'
        - 'Load'
        - '.xsl'
  filter:
    - CommandLine|contains:
        - 'C:\Windows\System32\wbem'
        - 'legitimate-script.xsl'
  condition: selection and not filter
fields:
  - Image
  - CommandLine
  - ParentImage
  - User
  - Hostname
level: high
tags:
  - attack.execution
  - attack.defense_evasion
  - t1220
falsepositives:
  - Legitimate administrative scripts or IT management tools using XSL for formatting.
