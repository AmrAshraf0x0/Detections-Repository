title: PowerShell Suspicious Script with Screenshot Capabilities
description: Detects PowerShell scripts that include functionality to capture screenshots, a common feature in post-exploitation kits and remote access tools (RATs).
status: Developed
date: 2024-12-01
author: Amr Ashraf
logsource:
  category: process_creation
  product: windows
detection:
  suspicious_screenshot_script:
    EventID: 4104
    ScriptBlockText|contains:
      - 'CopyFromScreen'
      - 'System.Drawing.Bitmap'
      - 'Drawing.Bitmap'
  condition: suspicious_screenshot_script
fields:
  - EventID
  - ScriptBlockText
  - SecurityID
falsepositives:
  - Authorized PowerShell scripts for legitimate administrative purposes
  - Testing or development activities in authorized environments
level: medium
tags:
  - attack.collection
  - attack.execution
  - attack.T1113
  - attack.T1059
  - attack.T1059.001
