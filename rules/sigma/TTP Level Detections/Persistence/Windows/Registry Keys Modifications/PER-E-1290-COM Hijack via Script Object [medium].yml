title: COM Hijack via Script Object
status: Developed
description: Identifies COM hijacking using the script object host `scrobj.dll`, which allows for stealthy execution of scripts in legitimate processes. This technique can be used for persistence or defense evasion.
author: Amr Ashraf
logsource:
  category: registry
  product: windows
detection:
  selection:
    - RegistryPath|contains: "\\_Classes\\CLSID\\{"
      RegistryPath|endswith: "\\InprocServer32"
      RegistryData|contains: "scrobj"
  condition: selection
fields:
  - RegistryPath
  - RegistryKey
  - RegistryValue
  - RegistryData
  - User
  - Hostname
  - Action
level: medium
tags:
  - attack.persistence
  - attack.defense_evasion
  - t1122
falsepositives:
  - Legitimate administrative changes or authorized software installations
  - System updates modifying COM registrations