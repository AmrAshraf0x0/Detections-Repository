title: Detect Sudo Token Abuse or Persistence
id: detect-sudo-token-abuse
status: Developed
description: Detects attempts to persist elevated privileges via sudo caching mechanisms (e.g., sudo -s, sudo -i).
author: Amr Ashraf
logsource:
  category: process_creation
  product: linux
detection:
  selection:
    Image: '/usr/bin/sudo'
    CommandLine|re: 
      - '.*sudo\s+-s.*'
      - '.*sudo\s+-i.*'
  condition: selection
fields:
  - Image
  - CommandLine
  - User
  - ParentImage
  - Hostname
level: high
tags:
  - attack.persistence
  - attack.privilege_escalation
  - t1548.003
falsepositives:
  - Legitimate administrative tasks
  - Maintenance scripts requiring persistent elevation
