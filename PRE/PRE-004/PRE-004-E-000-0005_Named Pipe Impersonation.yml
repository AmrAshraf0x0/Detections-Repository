title: Named Pipe Impersonation - PRE-004-E-000-0005
id: PRE-004-E-000-0005
status: experimental
description: |
  Detection Description:
  Detects Named Pipe Impersonation.
  
  Status:
  experimental
  
  Threat Mapping:
  MITRE ATT&CK Technique(s): T1134 â€“ Access Token Manipulation
  Kill Chain Phase: Privilege Escalation
  
  Data Sources:
  MITRE Data Source: Process: Process Creation
  Product targeted by the Rule: Windows Server
  Service in the product that provides the log: sysmon
  
  Detection Logic:
  See Sigma detection section.
  
  False Positive Considerations:
  See falsepositives section.
  
  Severity and Risk Rating:
  Severity Level: High
  
  References:
  See references section.
  
  Author:
  HXP Detection team
  
  Use Case Sheet Details:
  - L3 use cases per L2: 6
  - L1 Use Case Name: Privilege Escalation
  - L1 Use Case Identifier: PRE
  - L2 Use Case Name: Access Token Manipulation
  - L2 Use Case Identifier: PRE-004
  - Rule Identifier: PRE-004-E-000-0005
  - Technical Use Case Name: Named Pipe Impersonation
  - Use Case Description:
  - Log source type: Windows Servers
  - Detection Technology: SIEM
  - Scope: All assets
author: HXP Detection team
date: 2025-12-13
references:
  - https://attack.mitre.org/techniques/T1134/
  - https://learn.microsoft.com/sysinternals/downloads/sysmon
tags:
  - attack.privilege_escalation
  - attack.t1134
logsource:
  category: pipe_created
  product: windows
  service: sysmon
detection:
\
          selection:
            EventID: 17
          pipe_name:
            PipeName|contains:
              - '\pipe\spoolss'
              - '\pipe\lsarpc'
              - '\pipe\samr'
              - '\pipe\atsvc'
          suspicious_process:
            Image|endswith:
              - '\powershell.exe'
              - '\pwsh.exe'
              - '\cmd.exe'
              - '\rundll32.exe'
              - '\mshta.exe'
              - '\wscript.exe'
              - '\cscript.exe'
          condition: selection and pipe_name and suspicious_process
falsepositives:
  - Legitimate spooler / RPC pipes created by trusted processes (tune by Image)
  - Security testing
level: high
