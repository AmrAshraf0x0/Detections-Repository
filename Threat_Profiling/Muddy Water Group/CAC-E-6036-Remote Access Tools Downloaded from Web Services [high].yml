title: Remote Access Tools Downloaded from Web Services
status: test
description: Detects the use of cloud-based file-sharing services such as OneHub to download remote access tools, a tactic used by adversaries like MuddyWater.
author: Amr Ashraf
references:
    - https://attack.mitre.org/techniques/T1102/
    - https://attack.mitre.org/techniques/T1105/
tags:
    - attack.command_and_control
    - attack.resource_development
    - attack.t1102
    - attack.t1105
logsource:
    category: network_connection
    product: windows
detection:
    selection_http:
        DestinationHostname|contains:
            - 'onehub.com'
            - 'dropbox.com'
            - 'drive.google.com'
            - 'mega.nz'
            - 'mediafire.com'
            - 'sendspace.com'
            - 'anonfiles.com'
            - 'pastebin.com'
    selection_process:
        Image|contains:
            - '\powershell.exe'
            - '\curl.exe'
            - '\wget.exe'
            - '\bitsadmin.exe'
            - '\certutil.exe'
            - '\mshta.exe'
            - '\temp\'
            - '\public\' 
    condition: selection_http and selection_process
falsepositives:
    - Legitimate file downloads by users from cloud storage services
level: high
